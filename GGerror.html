<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>コードエラーチェック</title>
    <!-- ESLintのライブラリ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/eslint/8.11.0/eslint.min.js"></script>
    <!-- ESLintを実行するための設定 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/eslint/8.11.0/eslint.worker.min.js"></script>
</head>
<body>
    <h1>ゲームガーディアンのコードエラーチェック</h1>
    <form id="urlForm">
        <label for="rawUrl">Raw URLを入力してください:</label>
        <input type="text" id="rawUrl" name="rawUrl" required>
        <button type="submit">エラーチェック開始</button>
    </form>
    <pre id="codeDisplay"></pre>
    <div id="errorDisplay"></div>

    <script>
        document.getElementById('urlForm').addEventListener('submit', (event) => {
            event.preventDefault(); // フォームのデフォルトの送信を防ぐ
            const rawUrl = document.getElementById('rawUrl').value;

            fetch(rawUrl)
                .then(response => response.text())
                .then(code => {
                    document.getElementById('codeDisplay').textContent = code;

                    // ESLintの設定
                    const eslint = new eslint.Linter();
                    const messages = eslint.verify(code, {
                        rules: {
                            semi: "error",
                            "no-unused-vars": "warn"
                            // 他のルールも必要に応じて追加
                        },
                        env: {
                            browser: true,
                            es2021: true
                        }
                    });

                    if (messages.length > 0) {
                        const errorMessages = messages.map(message => {
                            return `ライン ${message.line}:${message.column} - ${message.message} (${message.ruleId})`;
                        }).join('\n');
                        document.getElementById('errorDisplay').textContent = errorMessages;
                    } else {
                        document.getElementById('errorDisplay').textContent = 'エラー無し';
                    }
                })
                .catch(err => {
                    document.getElementById('errorDisplay').textContent = `URL取得エラー: ${err.message}`;
                });
        });
    </script>
</body>
</html>
